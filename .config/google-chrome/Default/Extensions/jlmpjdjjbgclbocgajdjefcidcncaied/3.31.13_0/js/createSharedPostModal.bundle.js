"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[319],{91026:(e,t,n)=>{n.r(t),n.d(t,{CreateSharedPostModal:()=>k,default:()=>C});var r=n(51911),a=n(70468),l=n(53767),o=n(29901),i=n(97518),s=n(27846),u=n(60720),c=n(74418),d=n(97834),m=n(6189),p=n(86825),f=n(57767),v=n(22278),y=n(63061),g=n(43643),h=n(43641),b=n(57332),w=n(26013),x=n(44839),S=n(2469),N=["preview","squad","onSharedSuccessfully","onRequestClose"],P=o.createElement;function k(e){var t,n,k,C=e.preview,O=e.squad,E=e.onSharedSuccessfully,L=e.onRequestClose,_=(0,l.Z)(e,N),j=(0,o.useRef)(),q=(0,o.useState)(null!==(t=null!==(n=null==C?void 0:C.permalink)&&void 0!==n?n:null==C?void 0:C.url)&&void 0!==t?t:""),D=q[0],T=q[1],z=(0,x.j)(),Z=z.shouldShowCta,A=z.isEnabled,I=z.onToggle,R=z.onSubmitted,M=(0,d.x)({initialPreview:C,onPostSuccess:function(){E&&E(),R(),L(null)}}),F=M.getLinkPreview,U=M.isLoadingPreview,W=M.preview,H=M.isPosting,J=M.onSubmitPost,$=[null==W?void 0:W.url,null==W?void 0:W.permalink],X=(0,w.g)(F,(function(e){return $.every((function(t){return t!==e}))})),B=(0,a.Z)(X,1)[0],K=P(o.Fragment,null,P(m.zx,{icon:P(v.l,null),size:p.qE.Small,variant:p.Wu.Tertiary,onClick:null==j||null===(k=j.current)||void 0===k?void 0:k.onMentionCommand}),P(y.i,{vertical:!0}),P(h.Z,{source:O,size:"small"}),P("span",{className:"-ml-1 flex-1"},P("strong",null,O.name),P("span",{className:"ml-1 text-text-tertiary"},"@",O.handle))),Q={color:f.S.Cabbage,variant:p.Wu.Primary,disabled:H,loading:H};return P(i.u_,(0,r.Z)({kind:i.u_.Kind.FlexibleCenter,size:i.u_.Size.Medium,onRequestClose:L},_,{formProps:{form:"share_post",title:"New post",rightButtonProps:Q,copy:{right:"Post"}}}),P(i.u_.Header,{title:"New post"}),P("form",{className:"flex w-full flex-col p-3",action:"#",onSubmit:function(e){e.preventDefault();var t=(0,b.x)(e.currentTarget).commentary;return J(e,O.id,t)},id:"share_post"},P(s.Z,{ref:j,showUserAvatar:!0,textareaProps:{rows:5,name:"commentary"},sourceId:null==O?void 0:O.id,allowPreview:!1,enabledCommand:{mention:!0},footer:U?P(u.X,{link:D,className:"m-3 flex-col-reverse"}):P(c.A,{className:"m-3 !w-auto flex-col-reverse",preview:null!=W?W:C,link:D,onLinkChange:function(e){var t=e.currentTarget.value;T(t),B(t)}})}),Z&&P(S.r,{"data-testid":"push_notification-switch",inputId:"push_notification-switch",name:"push_notification",labelClassName:"flex-1 font-normal",className:"py-3",compact:!1,checked:A,onToggle:I},"Receive updates whenever your Squad members engage with your post")),P("span",{className:"flex flex-row items-center gap-2 px-4 tablet:hidden"},K),P(i.u_.Footer,{className:"typo-caption1",justify:g.WD.Start},K,P(m.zx,(0,r.Z)({},Q,{className:"ml-auto",form:"share_post"}),"Post")))}const C=k},74418:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(29901),a=n(33973),l=n(96883),o=n(71830),i=n(7675),s=n(53782),u=n(83103),c=n(6189),d=n(86825),m=r.createElement;function p(e){var t,n,r=e.link,p=e.preview,f=e.onLinkChange,v=e.className,y=e.isMinimized,g=e.showPreviewLink,h=void 0===g||g;return m(u.$i,{className:v},h&&m(a.n,{leftIcon:m(l.x,null),label:"URL",type:"url",name:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:r,onInput:f}),p.title&&p.image&&m(u.S5,{className:y&&"!px-3 !py-2"},m("div",{className:"flex flex-1 flex-col typo-footnote"},m("span",{className:"line-clamp-2 font-bold"},p.title),"unknown"!==(null===(t=p.source)||void 0===t?void 0:t.id)&&(y?m(i.e,{size:"small",source:p.source,className:"absolute right-24 mr-4 mt-1"}):m("span",{className:"mt-1 flex flex-row items-center"},m(i.e,{size:"small",source:p.source}),m("span",{className:"text-text-tertiary"},null===(n=p.source)||void 0===n?void 0:n.name)))),m(s.E,{className:u.JE,src:p.image,alt:"".concat(p.title)}),!y&&m(c.zx,{icon:m(o.h,null),variant:d.Wu.Tertiary,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:r})))}},60720:(e,t,n)=>{n.d(t,{X:()=>m});var r=n(29901),a=n(33973),l=n(86163),o=n(22057),i=n(71830),s=n(83103),u=n(6189),c=n(86825),d=r.createElement;function m(e){var t=e.link,n=e.className;return d(s.$i,{className:n},d(a.n,{leftIcon:d(l.a,{className:"mr-2"}),label:"URL",type:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:t}),d(s.S5,null,d("span",{className:"absolute left-2 top-2 text-text-quaternary typo-caption1"},"Fetching preview, please hold..."),d("div",{className:"flex flex-1 flex-col typo-footnote"},d("div",{className:"flex-flex-col relative"},d(o.f,{className:"h-2 w-5/6 rounded-12"}),d(o.f,{className:"mt-3 h-2 w-1/2 rounded-12"}))),d("div",{className:s.JE}),d(u.zx,{variant:c.Wu.Tertiary,icon:d(i.h,null),disabled:!0,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:t})))}},83103:(e,t,n)=>{n.d(t,{$i:()=>o,JE:()=>l,S5:()=>i});var r=n(99269),a=n(43643),l="w-28 h-16 rounded-12 bg-text-disabled object-cover",o=(0,r.Z)(a.Ht,"rounded-16 border border-border-subtlest-tertiary"),i=(0,r.Z)(a.gq,"relative gap-3 items-center py-5 px-4")},26013:(e,t,n)=>{n.d(t,{g:()=>l});var r=n(33014),a=n(28061),l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return(0,r.Z)((function(n){return(0,a.HH)(n)&&t(n)?e(n):null}),n)}},97834:(e,t,n)=>{n.d(t,{x:()=>w});var r=n(93309),a=n(28076),l=n(62699),o=n.n(l),i=n(48706),s=n(59266),u=n(29901),c=n(52210),d=n(57269),m=n(75160),p=n(64761),f=n(91255),v=n(24283),y=n(96543),g=n(63496);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=e.onPostSuccess,a=e.initialPreview,l=(0,m.sW)().displayToast,h=(0,v.Eu)().user,w=(0,i.NL)(),x=(0,y.o)().completeAction,S=(0,u.useState)(a),N=S[0],P=S[1],k=(0,g.Y)().requestMethod,C=(0,s.D)((function(e){return(0,c.v1)(e,k)}),{onSuccess:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],l=n[1];P(b(b({},a),{},{url:l})),null!=t&&t.onSuccess&&t.onSuccess.apply(t,n)},onError:function(e,n){var r,a,o=(0,d.tf)(e,d.MS.RateLimited),i=null!==(r=null==o?void 0:o.message)&&void 0!==r?r:d.JV;l(i);for(var s=arguments.length,u=new Array(s>2?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];null==t||null===(a=t.onError)||void 0===a||a.call.apply(a,[t,e,n].concat(u))}}),O=C.mutateAsync,E=C.isLoading,L=function(){var e=(0,r.Z)(o().mark((function e(){var t=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t.length>0&&void 0!==t[0]&&t[0]?"The post has been updated":"This post has been shared to your squad"),e.next=4,w.invalidateQueries(["sourceFeed",h.id]);case 4:x(f.Us.SquadFirstPost);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=(0,s.D)((0,p.nf)(k),{onSuccess:function(e){L(),n&&n(e,null==e?void 0:e.permalink)}}),j=_.mutateAsync,q=_.isLoading,D=_.isSuccess,T=(0,s.D)((0,p.EM)(k),{onSuccess:function(e){L(!0),n&&n(e,null==e?void 0:e.permalink)}}),z=T.mutateAsync,Z=T.isLoading,A=T.isSuccess,I=(0,s.D)((function(e){return(0,c.m5)(e,k)}),{onSuccess:function(e,t){var r=t.url;L(),n&&n(null,r)}}),R=I.mutateAsync,M=I.isLoading,F=I.isSuccess,U=q||M||D||F,W=A||Z;return{isLoadingPreview:E,getLinkPreview:O,onSubmitPost:(0,u.useCallback)((function(e,t,n){if(e.preventDefault(),U)return null;if(N.id)return j({id:N.id,sourceId:t,commentary:n});var r=N.title,a=N.image,o=N.url;return r?R({url:o,title:r,image:a,sourceId:t,commentary:n}):(l("Invalid link"),null)}),[N,l,R,j,U]),onUpdatePost:(0,u.useCallback)((function(e,t,n){return e.preventDefault(),W?null:z({id:t,commentary:n})}),[z,W]),isPosting:U,preview:N,onUpdatePreview:P}}}}]);