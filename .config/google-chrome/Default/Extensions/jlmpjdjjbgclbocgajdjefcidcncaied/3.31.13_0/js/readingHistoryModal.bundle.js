"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[653],{97912:(e,t,a)=>{a.r(t),a.d(t,{ReadingHistoryModal:()=>E,default:()=>M});var n=a(29901),o=a(97518),r=a(10807),l=a(99653),i=a(75943),s=a(4714),c=n.createElement;function u(e){var t=e.onArticleClick,a=e.data,n=e.canFetchMore,o=e.isFetchingNextPage,u=e.fetchNextPage;return c(r.Z,{canFetchMore:n,fetchNextPage:u,isFetchingNextPage:o},null==a?void 0:a.map((function(e){return c("button",{key:"".concat(e.post.id,"-").concat(e.timestamp),type:"button",className:"group relative -mx-6 cursor-pointer hover:bg-theme-hover",onClick:function(a){return t(a,e)},"aria-label":"Reading history item"},c(l.Z,{postItem:e,showButtons:!1,clickable:!1}),c(i.e0,{size:s.Jh.Medium,className:"absolute right-3 top-1/2 hidden -translate-y-1/2 rotate-90 group-hover:flex"}))})))}var d=a(24283),p=a(81358),f=a(28076),m=a(36909),g=a(91385),v=a.n(g),h=a(96206),x=a(47923);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,f.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const N=function(e){var t,a=e.key,o=e.query,r=e.variables,l=(0,m.N)(a,(function(e){var t=e.pageParam;return v()(h.B3,o,b(b({},r),{},{after:t}))}),{getNextPageParam:function(e){var t,a;return(null==e||null===(t=e.readHistory)||void 0===t?void 0:t.pageInfo.hasNextPage)&&(null==e||null===(a=e.readHistory)||void 0===a?void 0:a.pageInfo.endCursor)}}),i=l.isLoading,s=l.isFetchingNextPage,c=l.hasNextPage,u=l.data,d=l.fetchNextPage,p=!i&&!s&&c&&u.pages.length>0,f=(0,x.Z)({fetchPage:d,canFetchMore:p}),g=null==u||null===(t=u.pages)||void 0===t?void 0:t.some((function(e){return e.readHistory.edges.length>0}));return(0,n.useMemo)((function(){return{queryResult:l,hasData:g,isLoading:i,data:u,isInitialLoading:!g&&i,infiniteScrollRef:f}}),[g,l,i,u,f])};var P=function(){var e=(0,n.useContext)(d.ZP).user,t={key:["readHistory",null==e?void 0:e.id],query:p.dC,variables:{isPublic:!0}},a=N(t),o=a.hasData,l=a.data,i=a.isInitialLoading,s=a.isLoading,c=a.queryResult;return{data:(0,n.useMemo)((function(){return null==l?void 0:l.pages.map((function(e){return e.readHistory.edges.map((function(e){return e.node}))})).flat()}),[l]),hasData:o,isInitialLoading:i,isLoading:s,queryResult:c,canFetchMore:(0,r.H)(c),fetchNextPage:c.fetchNextPage,isFetchingNextPage:c.isFetchingNextPage}},w=a(99269),k=a(43643),S=(0,w.Z)("h1","text-center typo-large-title font-bold"),O=((0,w.Z)("p","text-center typo-title3 text-text-tertiary"),(0,w.Z)("span","text-brand-default")),C=((0,w.Z)(k.AC,"!p-0 laptop:min-h-page h-full !max-w-[42.5rem] !w-full",k.u7),(0,w.Z)("div","flex flex-1 flex-col"),(0,w.Z)("footer","flex sticky flex-row gap-3 items-center py-4 px-6 h-16 border-t border-border-subtlest-tertiary"),(0,w.Z)("header","flex sticky flex-row gap-3 items-center py-4 px-6 h-16 border-b border-border-subtlest-tertiary"),n.createElement);function D(e){var t=e.hasNoData;return C(n.Fragment,null,C(S,{className:"hidden tablet:block"},t?"Read":"Share"," ",C(O,null,"a post")),C("p",{className:"py-4 text-center"},t?"Your reading history is empty! Please read at least one post by clicking on a post to start sharing with your Squad.":"Pick a post that you would like to discuss with your Squad members."))}var F=a(22057),Z=n.createElement,q=(0,w.Z)(F.f,"h-3 rounded-12");const z=function(e){var t=e.amount;return Z("div",{className:"flex flex-col"},Array(void 0===t?7:t).fill(0).map((function(e,t){return Z("div",{key:t,className:"flex flex-row items-center px-8 py-3"},Z(F.f,{className:"h-16 w-16 rounded-16 laptop:w-24"}),Z("div",{className:"ml-4 flex flex-1 flex-col"},Z(q,{className:"w-full laptop:w-1/2"}),Z(q,{className:"mt-2 w-2/3 laptop:w-1/3"})))})))};var L=a(61289),j=n.createElement;function E(e){var t=e.keepOpenAfterSelecting,a=e.onArticleSelected,n=e.onRequestClose,r=P(),l=r.hasData,i=r.isInitialLoading,s=r.data,c=r.isLoading,d=r.canFetchMore,p=r.fetchNextPage,f=r.isFetchingNextPage,m=!l&&!i,g=m?"Read":"Share";return j(o.u_,{isOpen:!0,onRequestClose:n,kind:o.u_.Kind.FixedCenter,size:o.u_.Size.Small},j(o.u_.Header,{className:"flex tablet:hidden",kind:L.Li.Primary,title:"".concat(g," a post")}),j(o.u_.Body,null,j(D,{hasNoData:m}),j(u,{onArticleClick:function(e,o){a(o),t||n(e)},data:s,canFetchMore:d,fetchNextPage:p,isFetchingNextPage:f}),c&&j(z,{amount:i?15:1})))}const M=E},99653:(e,t,a)=>{a.d(t,{Z:()=>q});var n=a(29901),o=a(83849),r=a.n(o),l=a(34260),i=a.n(l),s=a(52210),c=a(32814),u=a(61741),d=a(38429),p=a(58764),f=a(99269),m=a(81618),g=a(77144),v=a(53782),h=a(10220),x=a(56567),y=a(48706),b=a(24283),N=a(43573),P=a(96521),w=a(86747),k=function(){var e=(0,y.NL)(),t=(0,n.useContext)(b.ZP).user;return(0,P.U)({variables:{key:N.dt.ReadingHistory},onMutate:function(a){var n=a.id,o=a.vote,r=e.getQueryData((0,N.e0)(N.dt.ReadingHistory,t));return(0,w.i)({id:n,vote:o,data:r,user:t,queryClient:e})}})},S=a(16309),O=a(6189),C=a(86825),D=a(57767),F=n.createElement,Z=(0,f.Z)("div","absolute left-5 -my-1 w-8 h-8 rounded-full bg-background-default");function q(e){var t,a,o,l,f,y=e.postItem,b=e.showButtons,N=void 0===b||b,P=e.clickable,w=void 0===P||P,q=e.onHide,z=e.className,L=e.onContextMenu,j=e.showVoteActions,E=void 0!==j&&j,M=e.analyticsOrigin,R=void 0===M?S.aP.Feed:M,H=y.timestampDb,I=y.post,A=null!==(t=null==I?void 0:I.sharedPost)&&void 0!==t?t:I,T=k(),U=T.toggleUpvote,_=T.toggleDownvote,B=r()("relative flex w-full flex-row py-3 pl-9 pr-5",E?"items-start tablet:items-center":"items-center",w&&"hover:cursor-pointer hover:bg-theme-hover",z);return F("article",{className:r()(!w&&B)},F(h.Z,{condition:w,wrapper:function(e){return F(i(),{href:I.commentsPermalink},F("a",{className:B,title:"Go to post"},e))}},F(n.Fragment,null,F(v.E,{src:A.image,alt:I.title,className:"h-16 w-16 rounded-16 object-cover laptop:w-24",loading:"lazy",fallbackSrc:x.n.post.imageCoverPlaceholder}),F(Z,{className:E&&"top-8"}),F(g.YY,{size:"small",rounded:"full",className:r()("absolute left-6",E&&"top-8"),user:{image:I.source.image,username:"source of ".concat(I.title)},nativeLazyLoading:!0}),F("div",{className:r()("flex flex-1",E?"flex-col tablet:flex-row":"items-center")},F("div",{className:"ml-4 flex flex-1 flex-col"},F("h3",{className:"mr-6 line-clamp-2 flex flex-1 break-words text-left typo-callout"},I.title),F(m.Z,{readTime:I.readTime,numUpvotes:I.numUpvotes,isVideoType:(0,s.AD)(I)})),F("div",{className:"ml-4 mt-1 flex tablet:ml-0 tablet:mt-1"},N&&E&&F(n.Fragment,null,F(O.zx,{size:C.qE.Small,variant:C.Wu.Tertiary,color:E?D.S.Avocado:void 0,className:E?"flex":"hidden laptop:flex",pressed:(null==I||null===(a=I.userState)||void 0===a?void 0:a.vote)===s.hn.Up,onClick:function(e){e.preventDefault(),U({payload:I,origin:R})},icon:F(c.o,{secondary:(null==I||null===(o=I.userState)||void 0===o?void 0:o.vote)===s.hn.Up})}),F(O.zx,{size:C.qE.Small,variant:C.Wu.Tertiary,color:E?D.S.Ketchup:void 0,className:E?"flex":"hidden laptop:flex",pressed:(null==I||null===(l=I.userState)||void 0===l?void 0:l.vote)===s.hn.Down,onClick:function(e){e.preventDefault(),_({payload:I,origin:R})},icon:F(u.I,{secondary:(null==I||null===(f=I.userState)||void 0===f?void 0:f.vote)===s.hn.Down})})),N&&!E&&q&&F(O.zx,{size:C.qE.Small,variant:C.Wu.Tertiary,className:"hidden laptop:flex",icon:F(d.q,null),onClick:function(e){e.stopPropagation(),e.preventDefault(),q({postId:I.id,timestamp:H})}}),N&&F(O.zx,{variant:C.Wu.Tertiary,"data-testid":"post-item-".concat(I.id),icon:F(p.O,null),onClick:function(e){e.stopPropagation(),L(e,y)},size:C.qE.Small}))))))}}}]);